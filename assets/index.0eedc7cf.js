import{V as c,M as P,C as z,B as O,L as k,a as H,S as W,E,b as S,c as p,G as C,P as T,T as L,d as q,e as I,f as N,g as U,h as Y,i as j,W as D,j as V,R as b,k as _,l as K,A as Z}from"./vendor.8eeffef9.js";const J=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function r(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(t){if(t.ep)return;t.ep=!0;const i=r(t);fetch(t.href,i)}};J();class Q{constructor(e){this.camera=e}Update(e){var r=new c;r.y=e.position.y+10,r.z=e.position.z+10,r.x=e.position.x,this.camera.position.lerp(r,.2)}}class X{constructor(e,r){this.curve,this.scene=r,this.CreateRoad(e),this.DrawRoad()}CreateRoad(e){let r=!1,o=[new c(0,0,0)],t=25;for(let s=1;s<=e.length;s++){let a,l=this.CreateSign(6,e[s-1]);r==!1?(a=new c(P.randFloat(5,20),0,s*t),o.push(a),l.position.set(a.x-10,0,a.z),r=!0):(a=new c(P.randFloat(-5,-20),0,s*t),o.push(a),l.position.set(a.x+10,0,a.z),r=!1)}o.push(new c(0,0,(e.length+1)*t)),console.log(o);const i=new z(o);i.type="chordal",i.closed=!1,this.curve=i}DrawRoad(){const e=this.curve.getPoints(80),r=new O().setFromPoints(e),o=new k({color:16777215}),t=new H(r,o);this.scene.add(t);var i={steps:100,bevelEnabled:!0,extrudePath:this.curve,bevelThickness:0},s=new W;s.moveTo(0,0),s.lineTo(0,-5),s.lineTo(0,5);var a=new E(s,i),l=new S({color:4606285,wireframe:!1}),h=new p(a,l);h.castShadow=!1,h.receiveShadow=!0,this.scene.add(h)}CreateSign(e,r){let o=new C,t=new T(10,5),i=new L().load(r),s=new q({map:i}),a=new p(t,s),l=new p(t,s);l.rotateY(Math.PI*1),a.position.y=e,l.position.y=e,a.castShadow=!0,a.receiveShadow=!0,l.castShadow=!0,l.receiveShadow=!0,o.add(a),o.add(l);let h=this.CreatePillar(e-a.geometry.parameters.height/2),x=this.CreatePillar(e-a.geometry.parameters.height/2),M=2;h.position.x=-a.geometry.parameters.width/2+M,x.position.x=a.geometry.parameters.width/2-M,o.add(h),o.add(x);let A=this.CreateFrame(a);return o.add(A),this.scene.add(o),o}CreatePillar(e){let r=new I(.2,.2,e,32),o=new S({color:5067095}),t=new p(r,o);return t.castShadow=!0,t.receiveShadow=!0,t.position.y=e/2,t}CreateFrame(e){let r=new C,o=e.geometry.parameters,t=this.CreateFrameBox(o.width+.1,.1),i=this.CreateFrameBox(o.width+.1,.1),s=this.CreateFrameBox(.1,o.height),a=this.CreateFrameBox(.1,o.height);return t.position.y=e.position.y+o.height/2,i.position.y=e.position.y+-o.height/2,s.position.y=e.position.y,a.position.y=e.position.y,s.position.x=-o.width/2,a.position.x=o.width/2,r.add(t),r.add(i),r.add(s),r.add(a),r}CreateFrameBox(e,r){let o=new N(e,r,.3),t=new S({color:5067095});return new p(o,t)}}class ${constructor(e,r){this.car=e,this.carPosition=new c,this.tangent=new c,this.lookAt=new c,this.velocity=0,this.progress=0,this.prevTime=performance.now(),this.car.castShadow=!0,this.car.receiveShadow=!0,r.add(this.car)}MoveCarOnRoad(e){const o=performance.now()-this.prevTime;this.progress+=this.velocity,this.progress=this.progress%1,this.carPosition.copy(e.getPointAt(this.progress)),this.carPosition.y+=.7,this.carPosition.x+=-3,this.car.position.copy(this.carPosition),this.tangent.copy(e.getTangentAt(this.progress)),this.velocity-=this.tangent.y*1e-7*o,this.velocity=Math.max(5e-4,Math.min(2e-4,this.velocity)),this.car.lookAt(this.lookAt.copy(this.carPosition).sub(this.tangent))}}const w=new U,m=new Y(75,window.innerWidth/window.innerHeight,.1,1e3);var F=new Q(m);const G=new j,u=new D({canvas:document.querySelector("#bg")});u.setPixelRatio(window.devicePixelRatio);u.setSize(window.innerWidth,window.innerHeight);u.shadowMap.enabled=!0;u.shadowMap.type=V;m.position.setZ(40);m.position.setY(20);const ee=new T(300,500);let v=new L().load("Materials/forest-floor/forest_floor_albedo.png");v.wrapS=b;v.wrapT=b;v.repeat.set(7,7);const te=new _({map:v}),f=new p(ee,te);f.receiveShadow=!0;f.castShadow=!0;f.position.setY(-.1);f.rotation.x=Math.PI*-.5;var g;G.load("car.glb",function(n){n.scene.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),g=new $(n.scene,w)});w.add(f);const y=new K(16777215,2);y.position.set(200,100,350);y.castShadow=!0;y.shadow.mapSize.width=1024*5;y.shadow.mapSize.height=1024*5;const oe=new Z(16777215,.7);w.add(y,oe);m.rotation.x=-.7;let re=["TeleTavleHelper.png","RandomSixOnline.png","TeleTavleHelper.png","TeleTavleHelper.png","TeleTavleHelper.png","TeleTavleHelper.png"];var R=new X(re,w),d;G.load("tunnel.glb",function(n){d=n.scene,d.position.set(0,4,0);let e=R.curve.getTangentAt(.003);e.y=d.position.y,d.lookAt(e),d.castShadow=!0,d.receiveShadow=!0,w.add(d)});document.body.onscroll=ae;function ae(){const n=document.body.getBoundingClientRect().top;g.position.z=-n*.01}function B(){requestAnimationFrame(B),g&&F&&(g.MoveCarOnRoad(R.curve),F.Update(g.car)),u.render(w,m)}B();
