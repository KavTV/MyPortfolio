import{G as L,V as c,M as w,C as q,B as N,L as U,a as Y,S as D,E as V,b as M,c as d,d as G,P as F,T as R,e as z,f as _,g as P,h as K,i as Z,W as J,j as Q,R as A,k as X,l as $,A as ee}from"./vendor.52b5e04f.js";const te=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerpolicy&&(a.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?a.credentials="include":t.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(t){if(t.ep)return;t.ep=!0;const a=o(t);fetch(t.href,a)}};te();class re{constructor(e){this.camera=e}Update(e){var o=new c;o.y=e.position.y+10,o.z=e.position.z+10,o.x=e.position.x,this.camera.position.lerp(o,.2)}}class oe{constructor(e,o){this.curve,this.scene=o,this.modelLoader=new L,this.CreateRoad(e),this.DrawRoad(),this.GenerateTrees(o,60)}CreateRoad(e){let o=!1,r=[new c(0,0,0)],t=25;for(let i=1;i<=e.length;i++){let n,l=this.CreateSign(6,e[i-1]);o==!1?(n=new c(w.randFloat(5,20),0,i*t),r.push(n),l.position.set(n.x-10,0,n.z),o=!0):(n=new c(w.randFloat(-5,-20),0,i*t),r.push(n),l.position.set(n.x+10,0,n.z),o=!1)}r.push(new c(0,0,(e.length+1)*t)),console.log(r);const a=new q(r);a.type="chordal",a.closed=!1,this.curve=a}DrawRoad(){const e=this.curve.getPoints(80),o=new N().setFromPoints(e),r=new U({color:16777215}),t=new Y(o,r);this.scene.add(t);var a={steps:100,bevelEnabled:!0,extrudePath:this.curve,bevelThickness:0},i=new D;i.moveTo(0,0),i.lineTo(0,-5),i.lineTo(0,5);var n=new V(i,a),l=new M({color:4606285,wireframe:!1}),p=new d(n,l);p.castShadow=!1,p.receiveShadow=!0,this.scene.add(p)}CreateSign(e,o){let r=new G,t=new F(10,5),a=new R().load(o),i=new z({map:a}),n=new d(t,i),l=new d(t,i);l.rotateY(Math.PI*1),n.position.y=e,l.position.y=e,n.castShadow=!0,n.receiveShadow=!0,l.castShadow=!0,l.receiveShadow=!0,r.add(n),r.add(l);let p=this.CreatePillar(e-n.geometry.parameters.height/2),C=this.CreatePillar(e-n.geometry.parameters.height/2),b=2;p.position.x=-n.geometry.parameters.width/2+b,C.position.x=n.geometry.parameters.width/2-b,r.add(p),r.add(C);let E=this.CreateFrame(n);return r.add(E),this.scene.add(r),r}CreatePillar(e){let o=new _(.2,.2,e,32),r=new M({color:5067095}),t=new d(o,r);return t.castShadow=!0,t.receiveShadow=!0,t.position.y=e/2,t}CreateFrame(e){let o=new G,r=e.geometry.parameters,t=this.CreateFrameBox(r.width+.1,.1),a=this.CreateFrameBox(r.width+.1,.1),i=this.CreateFrameBox(.1,r.height),n=this.CreateFrameBox(.1,r.height);return t.position.y=e.position.y+r.height/2,a.position.y=e.position.y+-r.height/2,i.position.y=e.position.y,n.position.y=e.position.y,i.position.x=-r.width/2,n.position.x=r.width/2,o.add(t),o.add(a),o.add(i),o.add(n),o}CreateFrameBox(e,o){let r=new P(e,o,.3),t=new M({color:5067095});return new d(r,t)}GenerateTree(e,o){let r=w.randInt(1,2);this.modelLoader.load("Objects/Tree"+r+".glb",function(t){let a=t.scene;a.position.set(o.x,o.y,o.z),t.scene.traverse(function(i){i.isMesh&&(i.castShadow=!0)}),e.add(a)})}GenerateTrees(e,o){let r=[];for(let t=0;t<o;t++){let a=0;for(;a<23&&a>-23;)a=w.randInt(-100,100);let i=new c(a,0,w.randInt(0,250));r.includes(i)==!1&&(this.GenerateTree(e,i),r.push(i))}}}class ae{constructor(e,o){this.car=e,this.carPosition=new c,this.tangent=new c,this.lookAt=new c,this.velocity=0,this.progress=0,this.prevTime=performance.now(),this.car.castShadow=!0,this.car.receiveShadow=!0,o.add(this.car)}MoveCarOnRoad(e){const r=performance.now()-this.prevTime;this.progress+=this.velocity,this.progress=this.progress%1,this.carPosition.copy(e.getPointAt(this.progress)),this.carPosition.y+=.7,this.carPosition.x+=-3,this.car.position.copy(this.carPosition),this.tangent.copy(e.getTangentAt(this.progress)),this.velocity-=this.tangent.y*1e-7*r,this.velocity=Math.max(5e-4,Math.min(2e-4,this.velocity)),this.car.lookAt(this.lookAt.copy(this.carPosition).sub(this.tangent))}}const h=new K,u=new Z(90,window.innerWidth/window.innerHeight,.1,1e3);var B=new re(u);const O=new L,m=new J({canvas:document.querySelector("#bg")});m.setPixelRatio(window.devicePixelRatio);m.setSize(window.innerWidth,window.innerHeight);m.shadowMap.enabled=!0;m.shadowMap.type=Q;u.position.setZ(40);u.position.setY(20);const k=new F(300,500);let x=new R().load("Materials/forest-floor/forest_floor_albedo.png");x.wrapS=A;x.wrapT=A;x.repeat.set(7,7);const ie=new X({map:x}),f=new d(k,ie);f.receiveShadow=!0;f.castShadow=!0;f.position.setY(-.1);f.rotation.x=Math.PI*-.5;var g;O.load("Objects/car.glb",function(s){s.scene.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),g=new ae(s.scene,h)});h.add(f);const y=new $(16777215,2);y.position.set(200,100,350);y.castShadow=!0;y.shadow.mapSize.width=1024*5;y.shadow.mapSize.height=1024*5;const ne=new ee(16777215,.7);h.add(y,ne);u.rotation.x=-.7;let se=["TeleTavleHelper.png","RandomSixOnline.png","TeleTavleHelper.png","TeleTavleHelper.png","TeleTavleHelper.png","TeleTavleHelper.png"];var H=new oe(se,h),v;let T=H.curve.getTangentAt(.003);O.load("Objects/tunnel.glb",function(s){v=s.scene,v.position.set(0,4,0),T.y=v.position.y,v.lookAt(T),s.scene.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),h.add(v)});let le=new P(k.parameters.width,250,2),ce=new P(20,40,15),I=new z({color:6844280}),j=new d(le,I),S=new d(ce,I);j.position.z=-8;S.lookAt(T);S.position.z-=7;S.position.x-=3;h.add(j,S);document.body.onscroll=de;function de(){const s=document.body.getBoundingClientRect().top;g.position.z=-s*.01}function W(){requestAnimationFrame(W),g&&B&&(g.MoveCarOnRoad(H.curve),B.Update(g.car)),m.render(h,u)}W();
